<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R for Social Science</title>
  <meta name="description" content="R for Social Science">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="R for Social Science" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R for Social Science" />
  
  
  

<meta name="author" content="Josiah Parry">


<meta name="date" content="2018-12-29">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="introducing-the-tidyverse.html">
<link rel="next" href="visualization.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#outline"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> The Basics</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#arithmetic-operators"><i class="fa fa-check"></i><b>1.1</b> Arithmetic Operators</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#creating-variables"><i class="fa fa-check"></i><b>1.2</b> Creating Variables</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#logical-operators"><i class="fa fa-check"></i><b>1.3</b> Logical operators</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#data-types"><i class="fa fa-check"></i><b>1.4</b> Data Types!</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#data-structures"><i class="fa fa-check"></i><b>1.5</b> Data Structures</a><ul>
<li class="chapter" data-level="1.5.1" data-path="intro.html"><a href="intro.html#vectors"><i class="fa fa-check"></i><b>1.5.1</b> Vectors</a></li>
<li class="chapter" data-level="1.5.2" data-path="intro.html"><a href="intro.html#data-frames"><i class="fa fa-check"></i><b>1.5.2</b> data frames</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#recap"><i class="fa fa-check"></i><b>1.6</b> Recap</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#hw"><i class="fa fa-check"></i><b>1.7</b> HW</a><ul>
<li class="chapter" data-level="1.7.1" data-path="intro.html"><a href="intro.html#hw-solutions"><i class="fa fa-check"></i><b>1.7.1</b> HW Solutions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introducing-the-tidyverse.html"><a href="introducing-the-tidyverse.html"><i class="fa fa-check"></i><b>2</b> Introducing the <code>tidyverse</code></a><ul>
<li class="chapter" data-level="2.1" data-path="introducing-the-tidyverse.html"><a href="introducing-the-tidyverse.html#selecting-data"><i class="fa fa-check"></i><b>2.1</b> Selecting data</a></li>
<li class="chapter" data-level="2.2" data-path="introducing-the-tidyverse.html"><a href="introducing-the-tidyverse.html#filtering-your-data"><i class="fa fa-check"></i><b>2.2</b> Filtering your data</a></li>
<li class="chapter" data-level="2.3" data-path="introducing-the-tidyverse.html"><a href="introducing-the-tidyverse.html#chaining-functions"><i class="fa fa-check"></i><b>2.3</b> Chaining functions</a></li>
<li class="chapter" data-level="2.4" data-path="introducing-the-tidyverse.html"><a href="introducing-the-tidyverse.html#creating-manipulating-data"><i class="fa fa-check"></i><b>2.4</b> Creating / manipulating data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="aggregation.html"><a href="aggregation.html"><i class="fa fa-check"></i><b>3</b> Aggregation</a><ul>
<li class="chapter" data-level="3.1" data-path="aggregation.html"><a href="aggregation.html#counting"><i class="fa fa-check"></i><b>3.1</b> Counting</a></li>
<li class="chapter" data-level="3.2" data-path="aggregation.html"><a href="aggregation.html#sub-setting"><i class="fa fa-check"></i><b>3.2</b> sub-setting</a></li>
<li class="chapter" data-level="3.3" data-path="aggregation.html"><a href="aggregation.html#summarising"><i class="fa fa-check"></i><b>3.3</b> Summarising</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>4</b> Visualization</a></li>
<li class="chapter" data-level="5" data-path="ok-but-where-gis.html"><a href="ok-but-where-gis.html"><i class="fa fa-check"></i><b>5</b> Ok, but where? (GIS)</a></li>
<li class="chapter" data-level="6" data-path="statistical-modelling-regression.html"><a href="statistical-modelling-regression.html"><i class="fa fa-check"></i><b>6</b> statistical modelling (Regression)</a></li>
<li class="chapter" data-level="7" data-path="data-preprocessing.html"><a href="data-preprocessing.html"><i class="fa fa-check"></i><b>7</b> Data preprocessing</a></li>
<li class="chapter" data-level="8" data-path="supervised-learning.html"><a href="supervised-learning.html"><i class="fa fa-check"></i><b>8</b> supervised learning</a></li>
<li class="chapter" data-level="9" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html"><i class="fa fa-check"></i><b>9</b> Unsupervised learning</a></li>
<li class="chapter" data-level="10" data-path="text-mining-natual-language-processing-nlp.html"><a href="text-mining-natual-language-processing-nlp.html"><i class="fa fa-check"></i><b>10</b> text-mining / natual language processing (nlp)</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Social Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="aggregation" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Aggregation</h1>
<p>Now that we have a basic understanding of how to manipulate our dataset, summarising the dataset into a few useful metrics is important. These summary stats will be useful in visualizing our data. There are three key functions that will be used <code>count()</code>, <code>group_by()</code>, and <code>summarise()</code>. When used creatively, <code>group_by()</code> and <code>summarise()</code> can provide some extremely insightful metrics.</p>
<div id="counting" class="section level2">
<h2><span class="header-section-number">3.1</span> Counting</h2>
<p>We will start with <code>count()</code>. Counting is the most basic(and useful) ooperation that we can do. To <code>count()</code> the number of observations in a dataframe, just pass the the tibble to the <code>count()</code> function either directly or with a pipe (<code>%&gt;%</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
counted &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/the-counted/counted.csv&quot;</span>)</code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   name = col_character(),
##   age = col_double(),
##   gender = col_character(),
##   raceethnicity = col_character(),
##   armed = col_character(),
##   date = col_date(format = &quot;&quot;),
##   streetaddress = col_character(),
##   city = col_character(),
##   state = col_character(),
##   latitude = col_double(),
##   longitude = col_double(),
##   classification = col_character(),
##   lawenforcementagency = col_character()
## )</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># count how many rows </span>
<span class="kw">count</span>(counted)</code></pre></div>
<pre><code>## # A tibble: 1 x 1
##       n
##   &lt;int&gt;
## 1  2226</code></pre>
<p>Here we see that there are 2226 recorded deaths in this dataset. That is a lot. We can pass other column names as additional arguments to count subsets of our data. So if we pass the <code>gender</code> column to <code>count()</code> we can see how many deaths there are by reported <code>gender</code> (I hesitate to use this column title, I would usually opt for <code>sex</code> as it is less ambiguous read the wiki page <a href="https://en.wikipedia.org/wiki/Sex_and_gender_distinction">here</a> for more).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">counted <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">count</span>(gender)</code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   gender             n
##   &lt;chr&gt;          &lt;int&gt;
## 1 Female           110
## 2 Male            2115
## 3 Non-conforming     1</code></pre>
<p>Ah, so here we see that the creators of this dataset are aware of gender non-conforming identities. We can also see that there seems to be a large gender discrepancy. These large numbers are informative, but often percentages or proportions are used to provide a bit more context. To extract this information we will need to utilise <code>group_by()</code> and <code>summarise()</code>. But first, we will go over <code>group_by()</code> briefly.</p>
</div>
<div id="sub-setting" class="section level2">
<h2><span class="header-section-number">3.2</span> sub-setting</h2>
<p>In the above example of <code>count()</code> we counted subsets of our data by telling <code>count()</code> which column to subset by. We can actually skip this step if we explicitly create a grouped data frame. This is done by using <code>group_by()</code>. As you probably guessed, we supply a column name to group by and create subsets from. On the surface this doesn’t do much. But if we group our dataframe and then look at the object’s class we will see that is has the class <code>grouped_df</code>, or <em>grouped data frame</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> counted <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(gender) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">class</span>()</code></pre></div>
<pre><code>## [1] &quot;grouped_df&quot; &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<p>Now that we know how to group the data, lets try couting our groups.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">counted <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(gender) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">count</span>()</code></pre></div>
<pre><code>## # A tibble: 3 x 2
## # Groups:   gender [3]
##   gender             n
##   &lt;chr&gt;          &lt;int&gt;
## 1 Female           110
## 2 Male            2115
## 3 Non-conforming     1</code></pre>
<p>In the above code we get the same result as writing <code>count(counted, gender)</code>, but in a slightly more verbose manner. But this is going to be useful in our summarisation!</p>
</div>
<div id="summarising" class="section level2">
<h2><span class="header-section-number">3.3</span> Summarising</h2>
<p>Here we see that there are 2226 recorded deaths in this dataset. That is a lot. But how many were there in each year? Currently, our dataset only has a column called <code>date</code> which contains the date of the event. Within that variable we can extract the year.</p>
<p>count, group_by, summarise,</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introducing-the-tidyverse.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="visualization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["tidy_socsci.pdf", "tidy_socsci.epub"]
});
});
</script>

</body>

</html>
